steps:
- task: AzureCLI@2
  inputs:
    azureSubscription: 'terraformtest'   # Name of your service connection
    scriptType: 'bash'
    scriptLocation: 'inlineScript'
    inlineScript: |
      # Install Terraform
      sudo apt-get update -y
      sudo apt-get install -y unzip wget
      wget https://releases.hashicorp.com/terraform/1.9.5/terraform_1.9.5_linux_amd64.zip
      sudo unzip -o terraform_1.9.5_linux_amd64.zip -d /usr/local/bin
      terraform version

      # Run Terraform
      terraform init
      terraform plan -out=tfplan
      terraform apply -auto-approve tfplan
